<!-- Node apple-find-me-account -->
<script type="text/javascript">
    RED.nodes.registerType('apple-find-me-account', {
        category: 'config',
        defaults: {
            name: {
                value: ""
            },
            //showfmly: { value: true },
            timezone: {
                value: "Europe/Berlin"
            },
            timeformat: {
                value: "YYYY-MM-DD HH:mm:ss"
            },
            timeout: {
                value: "5"
            }
            
        },
        credentials: {
            appleid: {
                type: "text"
            },
            password: {
                type: "password"
            }
        },
        color: '#D3D3D3',
        icon: "apple.svg",
        label: function() {
            return this.name || "Apple Account";
        },
        oneditsave: function() {
            console.log('save', this);
            var node = this;
            var appleid = $('#node-config-input-appleid').val();
            var password = $('#node-config-input-password').val();
            //var showfmly = $('#node-config-input-showfmly').val();
            var timezone = $('#node-config-input-timezone').val();
            var timeformat = $('#node-config-input-timeformat').val();
            var timeout = $('#node-config-input-timeout').val();
            if (password != '_PWD_') {
                var account = {
                    id: node.id,
                    appleid: appleid,
                    password: password,
                    //showfmly: showfmly,
                    timezone: timezone,
                    timeformat: timeformat
                }
                $.ajax({
                    data: JSON.stringify(account),
                    url: 'apple-find-me-account/new-account',
                    contentType: 'application/json',
                    type: 'POST',
                    processData: false
                });
            }
        },
        oneditprepare: function() {
            console.log('prepare', this);
            /*if (this.showfmly === undefined) {
                $("#node-config-input-showfmly").prop('checked', false);
            }*/
        },
        oneditsave: function() {
            console.log('saved', this);
        }
    });
</script>

<script type="text/x-red" data-template-name="apple-find-me-account">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name:</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-config-input-appleid"><i class="fa fa-id-card-o"></i> Apple ID:</label>
        <input type="text" id="node-config-input-appleid" placeholder="Apple ID">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-unlock-alt"></i> Password:</label>
        <input type="password" id="node-config-input-password" placeholder="Password for Apple ID">
    </div>
    <div class="form-row">
        <label for="node-config-input-timezone"><i class="fa fa-hourglass"></i> Timezone:</label>
        <!--<input type="text" id="node-config-input-timezone" placeholder="Timezone">-->
        <select id="node-config-input-timezone">
            <Option value='Africa/Abidjan'>Africa/Abidjan</Option>
            <Option value='Africa/Accra'>Africa/Accra</Option>
            <Option value='Africa/Addis_Ababa'>Africa/Addis_Ababa</Option>
            <Option value='Africa/Algiers'>Africa/Algiers</Option>
            <Option value='Africa/Asmara'>Africa/Asmara</Option>
            <Option value='Africa/Asmera'>Africa/Asmera</Option>
            <Option value='Africa/Bamako'>Africa/Bamako</Option>
            <Option value='Africa/Bangui'>Africa/Bangui</Option>
            <Option value='Africa/Banjul'>Africa/Banjul</Option>
            <Option value='Africa/Bissau'>Africa/Bissau</Option>
            <Option value='Africa/Blantyre'>Africa/Blantyre</Option>
            <Option value='Africa/Brazzaville'>Africa/Brazzaville</Option>
            <Option value='Africa/Bujumbura'>Africa/Bujumbura</Option>
            <Option value='Africa/Cairo'>Africa/Cairo</Option>
            <Option value='Africa/Casablanca'>Africa/Casablanca</Option>
            <Option value='Africa/Ceuta'>Africa/Ceuta</Option>
            <Option value='Africa/Conakry'>Africa/Conakry</Option>
            <Option value='Africa/Dakar'>Africa/Dakar</Option>
            <Option value='Africa/Dar_es_Salaam'>Africa/Dar_es_Salaam</Option>
            <Option value='Africa/Djibouti'>Africa/Djibouti</Option>
            <Option value='Africa/Douala'>Africa/Douala</Option>
            <Option value='Africa/El_Aaiun'>Africa/El_Aaiun</Option>
            <Option value='Africa/Freetown'>Africa/Freetown</Option>
            <Option value='Africa/Gaborone'>Africa/Gaborone</Option>
            <Option value='Africa/Harare'>Africa/Harare</Option>
            <Option value='Africa/Johannesburg'>Africa/Johannesburg</Option>
            <Option value='Africa/Juba'>Africa/Juba</Option>
            <Option value='Africa/Kampala'>Africa/Kampala</Option>
            <Option value='Africa/Khartoum'>Africa/Khartoum</Option>
            <Option value='Africa/Kigali'>Africa/Kigali</Option>
            <Option value='Africa/Kinshasa'>Africa/Kinshasa</Option>
            <Option value='Africa/Lagos'>Africa/Lagos</Option>
            <Option value='Africa/Libreville'>Africa/Libreville</Option>
            <Option value='Africa/Lome'>Africa/Lome</Option>
            <Option value='Africa/Luanda'>Africa/Luanda</Option>
            <Option value='Africa/Lubumbashi'>Africa/Lubumbashi</Option>
            <Option value='Africa/Lusaka'>Africa/Lusaka</Option>
            <Option value='Africa/Malabo'>Africa/Malabo</Option>
            <Option value='Africa/Maputo'>Africa/Maputo</Option>
            <Option value='Africa/Maseru'>Africa/Maseru</Option>
            <Option value='Africa/Mbabane'>Africa/Mbabane</Option>
            <Option value='Africa/Mogadishu'>Africa/Mogadishu</Option>
            <Option value='Africa/Monrovia'>Africa/Monrovia</Option>
            <Option value='Africa/Nairobi'>Africa/Nairobi</Option>
            <Option value='Africa/Ndjamena'>Africa/Ndjamena</Option>
            <Option value='Africa/Niamey'>Africa/Niamey</Option>
            <Option value='Africa/Nouakchott'>Africa/Nouakchott</Option>
            <Option value='Africa/Ouagadougou'>Africa/Ouagadougou</Option>
            <Option value='Africa/Porto-Novo'>Africa/Porto-Novo</Option>
            <Option value='Africa/Sao_Tome'>Africa/Sao_Tome</Option>
            <Option value='Africa/Timbuktu'>Africa/Timbuktu</Option>
            <Option value='Africa/Tripoli'>Africa/Tripoli</Option>
            <Option value='Africa/Tunis'>Africa/Tunis</Option>
            <Option value='Africa/Windhoek'>Africa/Windhoek</Option>
            <Option value='America/Adak'>America/Adak</Option>
            <Option value='America/Anchorage'>America/Anchorage</Option>
            <Option value='America/Anguilla'>America/Anguilla</Option>
            <Option value='America/Antigua'>America/Antigua</Option>
            <Option value='America/Araguaina'>America/Araguaina</Option>
            <Option value='America/Argentina/Buenos_Aires'>America/Argentina/Buenos_Aires</Option>
            <Option value='America/Argentina/Catamarca'>America/Argentina/Catamarca</Option>
            <Option value='America/Argentina/ComodRivadavia'>America/Argentina/ComodRivadavia</Option>
            <Option value='America/Argentina/Cordoba'>America/Argentina/Cordoba</Option>
            <Option value='America/Argentina/Jujuy'>America/Argentina/Jujuy</Option>
            <Option value='America/Argentina/La_Rioja'>America/Argentina/La_Rioja</Option>
            <Option value='America/Argentina/Mendoza'>America/Argentina/Mendoza</Option>
            <Option value='America/Argentina/Rio_Gallegos'>America/Argentina/Rio_Gallegos</Option>
            <Option value='America/Argentina/Salta'>America/Argentina/Salta</Option>
            <Option value='America/Argentina/San_Juan'>America/Argentina/San_Juan</Option>
            <Option value='America/Argentina/San_Luis'>America/Argentina/San_Luis</Option>
            <Option value='America/Argentina/Tucuman'>America/Argentina/Tucuman</Option>
            <Option value='America/Argentina/Ushuaia'>America/Argentina/Ushuaia</Option>
            <Option value='America/Aruba'>America/Aruba</Option>
            <Option value='America/Asuncion'>America/Asuncion</Option>
            <Option value='America/Atikokan'>America/Atikokan</Option>
            <Option value='America/Atka'>America/Atka</Option>
            <Option value='America/Bahia'>America/Bahia</Option>
            <Option value='America/Bahia_Banderas'>America/Bahia_Banderas</Option>
            <Option value='America/Barbados'>America/Barbados</Option>
            <Option value='America/Belem'>America/Belem</Option>
            <Option value='America/Belize'>America/Belize</Option>
            <Option value='America/Blanc-Sablon'>America/Blanc-Sablon</Option>
            <Option value='America/Boa_Vista'>America/Boa_Vista</Option>
            <Option value='America/Bogota'>America/Bogota</Option>
            <Option value='America/Boise'>America/Boise</Option>
            <Option value='America/Buenos_Aires'>America/Buenos_Aires</Option>
            <Option value='America/Cambridge_Bay'>America/Cambridge_Bay</Option>
            <Option value='America/Campo_Grande'>America/Campo_Grande</Option>
            <Option value='America/Cancun'>America/Cancun</Option>
            <Option value='America/Caracas'>America/Caracas</Option>
            <Option value='America/Catamarca'>America/Catamarca</Option>
            <Option value='America/Cayenne'>America/Cayenne</Option>
            <Option value='America/Cayman'>America/Cayman</Option>
            <Option value='America/Chicago'>America/Chicago</Option>
            <Option value='America/Chihuahua'>America/Chihuahua</Option>
            <Option value='America/Coral_Harbour'>America/Coral_Harbour</Option>
            <Option value='America/Cordoba'>America/Cordoba</Option>
            <Option value='America/Costa_Rica'>America/Costa_Rica</Option>
            <Option value='America/Creston'>America/Creston</Option>
            <Option value='America/Cuiaba'>America/Cuiaba</Option>
            <Option value='America/Curacao'>America/Curacao</Option>
            <Option value='America/Danmarkshavn'>America/Danmarkshavn</Option>
            <Option value='America/Dawson'>America/Dawson</Option>
            <Option value='America/Dawson_Creek'>America/Dawson_Creek</Option>
            <Option value='America/Denver'>America/Denver</Option>
            <Option value='America/Detroit'>America/Detroit</Option>
            <Option value='America/Dominica'>America/Dominica</Option>
            <Option value='America/Edmonton'>America/Edmonton</Option>
            <Option value='America/Eirunepe'>America/Eirunepe</Option>
            <Option value='America/El_Salvador'>America/El_Salvador</Option>
            <Option value='America/Ensenada'>America/Ensenada</Option>
            <Option value='America/Fort_Nelson'>America/Fort_Nelson</Option>
            <Option value='America/Fort_Wayne'>America/Fort_Wayne</Option>
            <Option value='America/Fortaleza'>America/Fortaleza</Option>
            <Option value='America/Glace_Bay'>America/Glace_Bay</Option>
            <Option value='America/Godthab'>America/Godthab</Option>
            <Option value='America/Goose_Bay'>America/Goose_Bay</Option>
            <Option value='America/Grand_Turk'>America/Grand_Turk</Option>
            <Option value='America/Grenada'>America/Grenada</Option>
            <Option value='America/Guadeloupe'>America/Guadeloupe</Option>
            <Option value='America/Guatemala'>America/Guatemala</Option>
            <Option value='America/Guayaquil'>America/Guayaquil</Option>
            <Option value='America/Guyana'>America/Guyana</Option>
            <Option value='America/Halifax'>America/Halifax</Option>
            <Option value='America/Havana'>America/Havana</Option>
            <Option value='America/Hermosillo'>America/Hermosillo</Option>
            <Option value='America/Indiana/Indianapolis'>America/Indiana/Indianapolis</Option>
            <Option value='America/Indiana/Knox'>America/Indiana/Knox</Option>
            <Option value='America/Indiana/Marengo'>America/Indiana/Marengo</Option>
            <Option value='America/Indiana/Petersburg'>America/Indiana/Petersburg</Option>
            <Option value='America/Indiana/Tell_City'>America/Indiana/Tell_City</Option>
            <Option value='America/Indiana/Vevay'>America/Indiana/Vevay</Option>
            <Option value='America/Indiana/Vincennes'>America/Indiana/Vincennes</Option>
            <Option value='America/Indiana/Winamac'>America/Indiana/Winamac</Option>
            <Option value='America/Indianapolis'>America/Indianapolis</Option>
            <Option value='America/Inuvik'>America/Inuvik</Option>
            <Option value='America/Iqaluit'>America/Iqaluit</Option>
            <Option value='America/Jamaica'>America/Jamaica</Option>
            <Option value='America/Jujuy'>America/Jujuy</Option>
            <Option value='America/Juneau'>America/Juneau</Option>
            <Option value='America/Kentucky/Louisville'>America/Kentucky/Louisville</Option>
            <Option value='America/Kentucky/Monticello'>America/Kentucky/Monticello</Option>
            <Option value='America/Knox_IN'>America/Knox_IN</Option>
            <Option value='America/Kralendijk'>America/Kralendijk</Option>
            <Option value='America/La_Paz'>America/La_Paz</Option>
            <Option value='America/Lima'>America/Lima</Option>
            <Option value='America/Los_Angeles'>America/Los_Angeles</Option>
            <Option value='America/Louisville'>America/Louisville</Option>
            <Option value='America/Lower_Princes'>America/Lower_Princes</Option>
            <Option value='America/Maceio'>America/Maceio</Option>
            <Option value='America/Managua'>America/Managua</Option>
            <Option value='America/Manaus'>America/Manaus</Option>
            <Option value='America/Marigot'>America/Marigot</Option>
            <Option value='America/Martinique'>America/Martinique</Option>
            <Option value='America/Matamoros'>America/Matamoros</Option>
            <Option value='America/Mazatlan'>America/Mazatlan</Option>
            <Option value='America/Mendoza'>America/Mendoza</Option>
            <Option value='America/Menominee'>America/Menominee</Option>
            <Option value='America/Merida'>America/Merida</Option>
            <Option value='America/Metlakatla'>America/Metlakatla</Option>
            <Option value='America/Mexico_City'>America/Mexico_City</Option>
            <Option value='America/Miquelon'>America/Miquelon</Option>
            <Option value='America/Moncton'>America/Moncton</Option>
            <Option value='America/Monterrey'>America/Monterrey</Option>
            <Option value='America/Montevideo'>America/Montevideo</Option>
            <Option value='America/Montreal'>America/Montreal</Option>
            <Option value='America/Montserrat'>America/Montserrat</Option>
            <Option value='America/Nassau'>America/Nassau</Option>
            <Option value='America/New_York'>America/New_York</Option>
            <Option value='America/Nipigon'>America/Nipigon</Option>
            <Option value='America/Nome'>America/Nome</Option>
            <Option value='America/Noronha'>America/Noronha</Option>
            <Option value='America/North_Dakota/Beulah'>America/North_Dakota/Beulah</Option>
            <Option value='America/North_Dakota/Center'>America/North_Dakota/Center</Option>
            <Option value='America/North_Dakota/New_Salem'>America/North_Dakota/New_Salem</Option>
            <Option value='America/Ojinaga'>America/Ojinaga</Option>
            <Option value='America/Panama'>America/Panama</Option>
            <Option value='America/Pangnirtung'>America/Pangnirtung</Option>
            <Option value='America/Paramaribo'>America/Paramaribo</Option>
            <Option value='America/Phoenix'>America/Phoenix</Option>
            <Option value='America/Port-au-Prince'>America/Port-au-Prince</Option>
            <Option value='America/Port_of_Spain'>America/Port_of_Spain</Option>
            <Option value='America/Porto_Acre'>America/Porto_Acre</Option>
            <Option value='America/Porto_Velho'>America/Porto_Velho</Option>
            <Option value='America/Puerto_Rico'>America/Puerto_Rico</Option>
            <Option value='America/Punta_Arenas'>America/Punta_Arenas</Option>
            <Option value='America/Rainy_River'>America/Rainy_River</Option>
            <Option value='America/Rankin_Inlet'>America/Rankin_Inlet</Option>
            <Option value='America/Recife'>America/Recife</Option>
            <Option value='America/Regina'>America/Regina</Option>
            <Option value='America/Resolute'>America/Resolute</Option>
            <Option value='America/Rio_Branco'>America/Rio_Branco</Option>
            <Option value='America/Rosario'>America/Rosario</Option>
            <Option value='America/Santa_Isabel'>America/Santa_Isabel</Option>
            <Option value='America/Santarem'>America/Santarem</Option>
            <Option value='America/Santiago'>America/Santiago</Option>
            <Option value='America/Santo_Domingo'>America/Santo_Domingo</Option>
            <Option value='America/Sao_Paulo'>America/Sao_Paulo</Option>
            <Option value='America/Scoresbysund'>America/Scoresbysund</Option>
            <Option value='America/Shiprock'>America/Shiprock</Option>
            <Option value='America/Sitka'>America/Sitka</Option>
            <Option value='America/St_Barthelemy'>America/St_Barthelemy</Option>
            <Option value='America/St_Johns'>America/St_Johns</Option>
            <Option value='America/St_Kitts'>America/St_Kitts</Option>
            <Option value='America/St_Lucia'>America/St_Lucia</Option>
            <Option value='America/St_Thomas'>America/St_Thomas</Option>
            <Option value='America/St_Vincent'>America/St_Vincent</Option>
            <Option value='America/Swift_Current'>America/Swift_Current</Option>
            <Option value='America/Tegucigalpa'>America/Tegucigalpa</Option>
            <Option value='America/Thule'>America/Thule</Option>
            <Option value='America/Thunder_Bay'>America/Thunder_Bay</Option>
            <Option value='America/Tijuana'>America/Tijuana</Option>
            <Option value='America/Toronto'>America/Toronto</Option>
            <Option value='America/Tortola'>America/Tortola</Option>
            <Option value='America/Vancouver'>America/Vancouver</Option>
            <Option value='America/Virgin'>America/Virgin</Option>
            <Option value='America/Whitehorse'>America/Whitehorse</Option>
            <Option value='America/Winnipeg'>America/Winnipeg</Option>
            <Option value='America/Yakutat'>America/Yakutat</Option>
            <Option value='America/Yellowknife'>America/Yellowknife</Option>
            <Option value='Antarctica/Casey'>Antarctica/Casey</Option>
            <Option value='Antarctica/Davis'>Antarctica/Davis</Option>
            <Option value='Antarctica/DumontDUrville'>Antarctica/DumontDUrville</Option>
            <Option value='Antarctica/Macquarie'>Antarctica/Macquarie</Option>
            <Option value='Antarctica/Mawson'>Antarctica/Mawson</Option>
            <Option value='Antarctica/McMurdo'>Antarctica/McMurdo</Option>
            <Option value='Antarctica/Palmer'>Antarctica/Palmer</Option>
            <Option value='Antarctica/Rothera'>Antarctica/Rothera</Option>
            <Option value='Antarctica/South_Pole'>Antarctica/South_Pole</Option>
            <Option value='Antarctica/Syowa'>Antarctica/Syowa</Option>
            <Option value='Antarctica/Troll'>Antarctica/Troll</Option>
            <Option value='Antarctica/Vostok'>Antarctica/Vostok</Option>
            <Option value='Arctic/Longyearbyen'>Arctic/Longyearbyen</Option>
            <Option value='Asia/Aden'>Asia/Aden</Option>
            <Option value='Asia/Almaty'>Asia/Almaty</Option>
            <Option value='Asia/Amman'>Asia/Amman</Option>
            <Option value='Asia/Anadyr'>Asia/Anadyr</Option>
            <Option value='Asia/Aqtau'>Asia/Aqtau</Option>
            <Option value='Asia/Aqtobe'>Asia/Aqtobe</Option>
            <Option value='Asia/Ashgabat'>Asia/Ashgabat</Option>
            <Option value='Asia/Ashkhabad'>Asia/Ashkhabad</Option>
            <Option value='Asia/Atyrau'>Asia/Atyrau</Option>
            <Option value='Asia/Baghdad'>Asia/Baghdad</Option>
            <Option value='Asia/Bahrain'>Asia/Bahrain</Option>
            <Option value='Asia/Baku'>Asia/Baku</Option>
            <Option value='Asia/Bangkok'>Asia/Bangkok</Option>
            <Option value='Asia/Barnaul'>Asia/Barnaul</Option>
            <Option value='Asia/Beirut'>Asia/Beirut</Option>
            <Option value='Asia/Bishkek'>Asia/Bishkek</Option>
            <Option value='Asia/Brunei'>Asia/Brunei</Option>
            <Option value='Asia/Calcutta'>Asia/Calcutta</Option>
            <Option value='Asia/Chita'>Asia/Chita</Option>
            <Option value='Asia/Choibalsan'>Asia/Choibalsan</Option>
            <Option value='Asia/Chongqing'>Asia/Chongqing</Option>
            <Option value='Asia/Chungking'>Asia/Chungking</Option>
            <Option value='Asia/Colombo'>Asia/Colombo</Option>
            <Option value='Asia/Dacca'>Asia/Dacca</Option>
            <Option value='Asia/Damascus'>Asia/Damascus</Option>
            <Option value='Asia/Dhaka'>Asia/Dhaka</Option>
            <Option value='Asia/Dili'>Asia/Dili</Option>
            <Option value='Asia/Dubai'>Asia/Dubai</Option>
            <Option value='Asia/Dushanbe'>Asia/Dushanbe</Option>
            <Option value='Asia/Famagusta'>Asia/Famagusta</Option>
            <Option value='Asia/Gaza'>Asia/Gaza</Option>
            <Option value='Asia/Harbin'>Asia/Harbin</Option>
            <Option value='Asia/Hebron'>Asia/Hebron</Option>
            <Option value='Asia/Ho_Chi_Minh'>Asia/Ho_Chi_Minh</Option>
            <Option value='Asia/Hong_Kong'>Asia/Hong_Kong</Option>
            <Option value='Asia/Hovd'>Asia/Hovd</Option>
            <Option value='Asia/Irkutsk'>Asia/Irkutsk</Option>
            <Option value='Asia/Istanbul'>Asia/Istanbul</Option>
            <Option value='Asia/Jakarta'>Asia/Jakarta</Option>
            <Option value='Asia/Jayapura'>Asia/Jayapura</Option>
            <Option value='Asia/Jerusalem'>Asia/Jerusalem</Option>
            <Option value='Asia/Kabul'>Asia/Kabul</Option>
            <Option value='Asia/Kamchatka'>Asia/Kamchatka</Option>
            <Option value='Asia/Karachi'>Asia/Karachi</Option>
            <Option value='Asia/Kashgar'>Asia/Kashgar</Option>
            <Option value='Asia/Kathmandu'>Asia/Kathmandu</Option>
            <Option value='Asia/Katmandu'>Asia/Katmandu</Option>
            <Option value='Asia/Khandyga'>Asia/Khandyga</Option>
            <Option value='Asia/Kolkata'>Asia/Kolkata</Option>
            <Option value='Asia/Krasnoyarsk'>Asia/Krasnoyarsk</Option>
            <Option value='Asia/Kuala_Lumpur'>Asia/Kuala_Lumpur</Option>
            <Option value='Asia/Kuching'>Asia/Kuching</Option>
            <Option value='Asia/Kuwait'>Asia/Kuwait</Option>
            <Option value='Asia/Macao'>Asia/Macao</Option>
            <Option value='Asia/Macau'>Asia/Macau</Option>
            <Option value='Asia/Magadan'>Asia/Magadan</Option>
            <Option value='Asia/Makassar'>Asia/Makassar</Option>
            <Option value='Asia/Manila'>Asia/Manila</Option>
            <Option value='Asia/Muscat'>Asia/Muscat</Option>
            <Option value='Asia/Nicosia'>Asia/Nicosia</Option>
            <Option value='Asia/Novokuznetsk'>Asia/Novokuznetsk</Option>
            <Option value='Asia/Novosibirsk'>Asia/Novosibirsk</Option>
            <Option value='Asia/Omsk'>Asia/Omsk</Option>
            <Option value='Asia/Oral'>Asia/Oral</Option>
            <Option value='Asia/Phnom_Penh'>Asia/Phnom_Penh</Option>
            <Option value='Asia/Pontianak'>Asia/Pontianak</Option>
            <Option value='Asia/Pyongyang'>Asia/Pyongyang</Option>
            <Option value='Asia/Qatar'>Asia/Qatar</Option>
            <Option value='Asia/Qyzylorda'>Asia/Qyzylorda</Option>
            <Option value='Asia/Rangoon'>Asia/Rangoon</Option>
            <Option value='Asia/Riyadh'>Asia/Riyadh</Option>
            <Option value='Asia/Saigon'>Asia/Saigon</Option>
            <Option value='Asia/Sakhalin'>Asia/Sakhalin</Option>
            <Option value='Asia/Samarkand'>Asia/Samarkand</Option>
            <Option value='Asia/Seoul'>Asia/Seoul</Option>
            <Option value='Asia/Shanghai'>Asia/Shanghai</Option>
            <Option value='Asia/Singapore'>Asia/Singapore</Option>
            <Option value='Asia/Srednekolymsk'>Asia/Srednekolymsk</Option>
            <Option value='Asia/Taipei'>Asia/Taipei</Option>
            <Option value='Asia/Tashkent'>Asia/Tashkent</Option>
            <Option value='Asia/Tbilisi'>Asia/Tbilisi</Option>
            <Option value='Asia/Tehran'>Asia/Tehran</Option>
            <Option value='Asia/Tel_Aviv'>Asia/Tel_Aviv</Option>
            <Option value='Asia/Thimbu'>Asia/Thimbu</Option>
            <Option value='Asia/Thimphu'>Asia/Thimphu</Option>
            <Option value='Asia/Tokyo'>Asia/Tokyo</Option>
            <Option value='Asia/Tomsk'>Asia/Tomsk</Option>
            <Option value='Asia/Ujung_Pandang'>Asia/Ujung_Pandang</Option>
            <Option value='Asia/Ulaanbaatar'>Asia/Ulaanbaatar</Option>
            <Option value='Asia/Ulan_Bator'>Asia/Ulan_Bator</Option>
            <Option value='Asia/Urumqi'>Asia/Urumqi</Option>
            <Option value='Asia/Ust-Nera'>Asia/Ust-Nera</Option>
            <Option value='Asia/Vientiane'>Asia/Vientiane</Option>
            <Option value='Asia/Vladivostok'>Asia/Vladivostok</Option>
            <Option value='Asia/Yakutsk'>Asia/Yakutsk</Option>
            <Option value='Asia/Yangon'>Asia/Yangon</Option>
            <Option value='Asia/Yekaterinburg'>Asia/Yekaterinburg</Option>
            <Option value='Asia/Yerevan'>Asia/Yerevan</Option>
            <Option value='Atlantic/Azores'>Atlantic/Azores</Option>
            <Option value='Atlantic/Bermuda'>Atlantic/Bermuda</Option>
            <Option value='Atlantic/Canary'>Atlantic/Canary</Option>
            <Option value='Atlantic/Cape_Verde'>Atlantic/Cape_Verde</Option>
            <Option value='Atlantic/Faeroe'>Atlantic/Faeroe</Option>
            <Option value='Atlantic/Faroe'>Atlantic/Faroe</Option>
            <Option value='Atlantic/Jan_Mayen'>Atlantic/Jan_Mayen</Option>
            <Option value='Atlantic/Madeira'>Atlantic/Madeira</Option>
            <Option value='Atlantic/Reykjavik'>Atlantic/Reykjavik</Option>
            <Option value='Atlantic/South_Georgia'>Atlantic/South_Georgia</Option>
            <Option value='Atlantic/St_Helena'>Atlantic/St_Helena</Option>
            <Option value='Atlantic/Stanley'>Atlantic/Stanley</Option>
            <Option value='Australia/ACT'>Australia/ACT</Option>
            <Option value='Australia/Adelaide'>Australia/Adelaide</Option>
            <Option value='Australia/Brisbane'>Australia/Brisbane</Option>
            <Option value='Australia/Broken_Hill'>Australia/Broken_Hill</Option>
            <Option value='Australia/Canberra'>Australia/Canberra</Option>
            <Option value='Australia/Currie'>Australia/Currie</Option>
            <Option value='Australia/Darwin'>Australia/Darwin</Option>
            <Option value='Australia/Eucla'>Australia/Eucla</Option>
            <Option value='Australia/Hobart'>Australia/Hobart</Option>
            <Option value='Australia/LHI'>Australia/LHI</Option>
            <Option value='Australia/Lindeman'>Australia/Lindeman</Option>
            <Option value='Australia/Lord_Howe'>Australia/Lord_Howe</Option>
            <Option value='Australia/Melbourne'>Australia/Melbourne</Option>
            <Option value='Australia/NSW'>Australia/NSW</Option>
            <Option value='Australia/North'>Australia/North</Option>
            <Option value='Australia/Perth'>Australia/Perth</Option>
            <Option value='Australia/Queensland'>Australia/Queensland</Option>
            <Option value='Australia/South'>Australia/South</Option>
            <Option value='Australia/Sydney'>Australia/Sydney</Option>
            <Option value='Australia/Tasmania'>Australia/Tasmania</Option>
            <Option value='Australia/Victoria'>Australia/Victoria</Option>
            <Option value='Australia/West'>Australia/West</Option>
            <Option value='Australia/Yancowinna'>Australia/Yancowinna</Option>
            <Option value='Brazil/Acre'>Brazil/Acre</Option>
            <Option value='Brazil/DeNoronha'>Brazil/DeNoronha</Option>
            <Option value='Brazil/East'>Brazil/East</Option>
            <Option value='Brazil/West'>Brazil/West</Option>
            <Option value='CET'>CET</Option>
            <Option value='CST6CDT'>CST6CDT</Option>
            <Option value='Canada/Atlantic'>Canada/Atlantic</Option>
            <Option value='Canada/Central'>Canada/Central</Option>
            <Option value='Canada/Eastern'>Canada/Eastern</Option>
            <Option value='Canada/Mountain'>Canada/Mountain</Option>
            <Option value='Canada/Newfoundland'>Canada/Newfoundland</Option>
            <Option value='Canada/Pacific'>Canada/Pacific</Option>
            <Option value='Canada/Saskatchewan'>Canada/Saskatchewan</Option>
            <Option value='Canada/Yukon'>Canada/Yukon</Option>
            <Option value='Chile/Continental'>Chile/Continental</Option>
            <Option value='Chile/EasterIsland'>Chile/EasterIsland</Option>
            <Option value='Cuba'>Cuba</Option>
            <Option value='EET'>EET</Option>
            <Option value='EST'>EST</Option>
            <Option value='EST5EDT'>EST5EDT</Option>
            <Option value='Egypt'>Egypt</Option>
            <Option value='Eire'>Eire</Option>
            <Option value='Etc/GMT'>Etc/GMT</Option>
            <Option value='Etc/GMT+0'>Etc/GMT+0</Option>
            <Option value='Etc/GMT+1'>Etc/GMT+1</Option>
            <Option value='Etc/GMT+10'>Etc/GMT+10</Option>
            <Option value='Etc/GMT+11'>Etc/GMT+11</Option>
            <Option value='Etc/GMT+12'>Etc/GMT+12</Option>
            <Option value='Etc/GMT+2'>Etc/GMT+2</Option>
            <Option value='Etc/GMT+3'>Etc/GMT+3</Option>
            <Option value='Etc/GMT+4'>Etc/GMT+4</Option>
            <Option value='Etc/GMT+5'>Etc/GMT+5</Option>
            <Option value='Etc/GMT+6'>Etc/GMT+6</Option>
            <Option value='Etc/GMT+7'>Etc/GMT+7</Option>
            <Option value='Etc/GMT+8'>Etc/GMT+8</Option>
            <Option value='Etc/GMT+9'>Etc/GMT+9</Option>
            <Option value='Etc/GMT-0'>Etc/GMT-0</Option>
            <Option value='Etc/GMT-1'>Etc/GMT-1</Option>
            <Option value='Etc/GMT-10'>Etc/GMT-10</Option>
            <Option value='Etc/GMT-11'>Etc/GMT-11</Option>
            <Option value='Etc/GMT-12'>Etc/GMT-12</Option>
            <Option value='Etc/GMT-13'>Etc/GMT-13</Option>
            <Option value='Etc/GMT-14'>Etc/GMT-14</Option>
            <Option value='Etc/GMT-2'>Etc/GMT-2</Option>
            <Option value='Etc/GMT-3'>Etc/GMT-3</Option>
            <Option value='Etc/GMT-4'>Etc/GMT-4</Option>
            <Option value='Etc/GMT-5'>Etc/GMT-5</Option>
            <Option value='Etc/GMT-6'>Etc/GMT-6</Option>
            <Option value='Etc/GMT-7'>Etc/GMT-7</Option>
            <Option value='Etc/GMT-8'>Etc/GMT-8</Option>
            <Option value='Etc/GMT-9'>Etc/GMT-9</Option>
            <Option value='Etc/GMT0'>Etc/GMT0</Option>
            <Option value='Etc/Greenwich'>Etc/Greenwich</Option>
            <Option value='Etc/UCT'>Etc/UCT</Option>
            <Option value='Etc/UTC'>Etc/UTC</Option>
            <Option value='Etc/Universal'>Etc/Universal</Option>
            <Option value='Etc/Zulu'>Etc/Zulu</Option>
            <Option value='Europe/Amsterdam'>Europe/Amsterdam</Option>
            <Option value='Europe/Andorra'>Europe/Andorra</Option>
            <Option value='Europe/Astrakhan'>Europe/Astrakhan</Option>
            <Option value='Europe/Athens'>Europe/Athens</Option>
            <Option value='Europe/Belfast'>Europe/Belfast</Option>
            <Option value='Europe/Belgrade'>Europe/Belgrade</Option>
            <Option value='Europe/Berlin'>Europe/Berlin</Option>
            <Option value='Europe/Bratislava'>Europe/Bratislava</Option>
            <Option value='Europe/Brussels'>Europe/Brussels</Option>
            <Option value='Europe/Bucharest'>Europe/Bucharest</Option>
            <Option value='Europe/Budapest'>Europe/Budapest</Option>
            <Option value='Europe/Busingen'>Europe/Busingen</Option>
            <Option value='Europe/Chisinau'>Europe/Chisinau</Option>
            <Option value='Europe/Copenhagen'>Europe/Copenhagen</Option>
            <Option value='Europe/Dublin'>Europe/Dublin</Option>
            <Option value='Europe/Gibraltar'>Europe/Gibraltar</Option>
            <Option value='Europe/Guernsey'>Europe/Guernsey</Option>
            <Option value='Europe/Helsinki'>Europe/Helsinki</Option>
            <Option value='Europe/Isle_of_Man'>Europe/Isle_of_Man</Option>
            <Option value='Europe/Istanbul'>Europe/Istanbul</Option>
            <Option value='Europe/Jersey'>Europe/Jersey</Option>
            <Option value='Europe/Kaliningrad'>Europe/Kaliningrad</Option>
            <Option value='Europe/Kiev'>Europe/Kiev</Option>
            <Option value='Europe/Kirov'>Europe/Kirov</Option>
            <Option value='Europe/Lisbon'>Europe/Lisbon</Option>
            <Option value='Europe/Ljubljana'>Europe/Ljubljana</Option>
            <Option value='Europe/London'>Europe/London</Option>
            <Option value='Europe/Luxembourg'>Europe/Luxembourg</Option>
            <Option value='Europe/Madrid'>Europe/Madrid</Option>
            <Option value='Europe/Malta'>Europe/Malta</Option>
            <Option value='Europe/Mariehamn'>Europe/Mariehamn</Option>
            <Option value='Europe/Minsk'>Europe/Minsk</Option>
            <Option value='Europe/Monaco'>Europe/Monaco</Option>
            <Option value='Europe/Moscow'>Europe/Moscow</Option>
            <Option value='Europe/Nicosia'>Europe/Nicosia</Option>
            <Option value='Europe/Oslo'>Europe/Oslo</Option>
            <Option value='Europe/Paris'>Europe/Paris</Option>
            <Option value='Europe/Podgorica'>Europe/Podgorica</Option>
            <Option value='Europe/Prague'>Europe/Prague</Option>
            <Option value='Europe/Riga'>Europe/Riga</Option>
            <Option value='Europe/Rome'>Europe/Rome</Option>
            <Option value='Europe/Samara'>Europe/Samara</Option>
            <Option value='Europe/San_Marino'>Europe/San_Marino</Option>
            <Option value='Europe/Sarajevo'>Europe/Sarajevo</Option>
            <Option value='Europe/Saratov'>Europe/Saratov</Option>
            <Option value='Europe/Simferopol'>Europe/Simferopol</Option>
            <Option value='Europe/Skopje'>Europe/Skopje</Option>
            <Option value='Europe/Sofia'>Europe/Sofia</Option>
            <Option value='Europe/Stockholm'>Europe/Stockholm</Option>
            <Option value='Europe/Tallinn'>Europe/Tallinn</Option>
            <Option value='Europe/Tirane'>Europe/Tirane</Option>
            <Option value='Europe/Tiraspol'>Europe/Tiraspol</Option>
            <Option value='Europe/Ulyanovsk'>Europe/Ulyanovsk</Option>
            <Option value='Europe/Uzhgorod'>Europe/Uzhgorod</Option>
            <Option value='Europe/Vaduz'>Europe/Vaduz</Option>
            <Option value='Europe/Vatican'>Europe/Vatican</Option>
            <Option value='Europe/Vienna'>Europe/Vienna</Option>
            <Option value='Europe/Vilnius'>Europe/Vilnius</Option>
            <Option value='Europe/Volgograd'>Europe/Volgograd</Option>
            <Option value='Europe/Warsaw'>Europe/Warsaw</Option>
            <Option value='Europe/Zagreb'>Europe/Zagreb</Option>
            <Option value='Europe/Zaporozhye'>Europe/Zaporozhye</Option>
            <Option value='Europe/Zurich'>Europe/Zurich</Option>
            <Option value='GB'>GB</Option>
            <Option value='GB-Eire'>GB-Eire</Option>
            <Option value='GMT'>GMT</Option>
            <Option value='GMT+0'>GMT+0</Option>
            <Option value='GMT-0'>GMT-0</Option>
            <Option value='GMT0'>GMT0</Option>
            <Option value='Greenwich'>Greenwich</Option>
            <Option value='HST'>HST</Option>
            <Option value='Hongkong'>Hongkong</Option>
            <Option value='Iceland'>Iceland</Option>
            <Option value='Indian/Antananarivo'>Indian/Antananarivo</Option>
            <Option value='Indian/Chagos'>Indian/Chagos</Option>
            <Option value='Indian/Christmas'>Indian/Christmas</Option>
            <Option value='Indian/Cocos'>Indian/Cocos</Option>
            <Option value='Indian/Comoro'>Indian/Comoro</Option>
            <Option value='Indian/Kerguelen'>Indian/Kerguelen</Option>
            <Option value='Indian/Mahe'>Indian/Mahe</Option>
            <Option value='Indian/Maldives'>Indian/Maldives</Option>
            <Option value='Indian/Mauritius'>Indian/Mauritius</Option>
            <Option value='Indian/Mayotte'>Indian/Mayotte</Option>
            <Option value='Indian/Reunion'>Indian/Reunion</Option>
            <Option value='Iran'>Iran</Option>
            <Option value='Israel'>Israel</Option>
            <Option value='Jamaica'>Jamaica</Option>
            <Option value='Japan'>Japan</Option>
            <Option value='Kwajalein'>Kwajalein</Option>
            <Option value='Libya'>Libya</Option>
            <Option value='MET'>MET</Option>
            <Option value='MST'>MST</Option>
            <Option value='MST7MDT'>MST7MDT</Option>
            <Option value='Mexico/BajaNorte'>Mexico/BajaNorte</Option>
            <Option value='Mexico/BajaSur'>Mexico/BajaSur</Option>
            <Option value='Mexico/General'>Mexico/General</Option>
            <Option value='NZ'>NZ</Option>
            <Option value='NZ-CHAT'>NZ-CHAT</Option>
            <Option value='Navajo'>Navajo</Option>
            <Option value='PRC'>PRC</Option>
            <Option value='PST8PDT'>PST8PDT</Option>
            <Option value='Pacific/Apia'>Pacific/Apia</Option>
            <Option value='Pacific/Auckland'>Pacific/Auckland</Option>
            <Option value='Pacific/Bougainville'>Pacific/Bougainville</Option>
            <Option value='Pacific/Chatham'>Pacific/Chatham</Option>
            <Option value='Pacific/Chuuk'>Pacific/Chuuk</Option>
            <Option value='Pacific/Easter'>Pacific/Easter</Option>
            <Option value='Pacific/Efate'>Pacific/Efate</Option>
            <Option value='Pacific/Enderbury'>Pacific/Enderbury</Option>
            <Option value='Pacific/Fakaofo'>Pacific/Fakaofo</Option>
            <Option value='Pacific/Fiji'>Pacific/Fiji</Option>
            <Option value='Pacific/Funafuti'>Pacific/Funafuti</Option>
            <Option value='Pacific/Galapagos'>Pacific/Galapagos</Option>
            <Option value='Pacific/Gambier'>Pacific/Gambier</Option>
            <Option value='Pacific/Guadalcanal'>Pacific/Guadalcanal</Option>
            <Option value='Pacific/Guam'>Pacific/Guam</Option>
            <Option value='Pacific/Honolulu'>Pacific/Honolulu</Option>
            <Option value='Pacific/Johnston'>Pacific/Johnston</Option>
            <Option value='Pacific/Kiritimati'>Pacific/Kiritimati</Option>
            <Option value='Pacific/Kosrae'>Pacific/Kosrae</Option>
            <Option value='Pacific/Kwajalein'>Pacific/Kwajalein</Option>
            <Option value='Pacific/Majuro'>Pacific/Majuro</Option>
            <Option value='Pacific/Marquesas'>Pacific/Marquesas</Option>
            <Option value='Pacific/Midway'>Pacific/Midway</Option>
            <Option value='Pacific/Nauru'>Pacific/Nauru</Option>
            <Option value='Pacific/Niue'>Pacific/Niue</Option>
            <Option value='Pacific/Norfolk'>Pacific/Norfolk</Option>
            <Option value='Pacific/Noumea'>Pacific/Noumea</Option>
            <Option value='Pacific/Pago_Pago'>Pacific/Pago_Pago</Option>
            <Option value='Pacific/Palau'>Pacific/Palau</Option>
            <Option value='Pacific/Pitcairn'>Pacific/Pitcairn</Option>
            <Option value='Pacific/Pohnpei'>Pacific/Pohnpei</Option>
            <Option value='Pacific/Ponape'>Pacific/Ponape</Option>
            <Option value='Pacific/Port_Moresby'>Pacific/Port_Moresby</Option>
            <Option value='Pacific/Rarotonga'>Pacific/Rarotonga</Option>
            <Option value='Pacific/Saipan'>Pacific/Saipan</Option>
            <Option value='Pacific/Samoa'>Pacific/Samoa</Option>
            <Option value='Pacific/Tahiti'>Pacific/Tahiti</Option>
            <Option value='Pacific/Tarawa'>Pacific/Tarawa</Option>
            <Option value='Pacific/Tongatapu'>Pacific/Tongatapu</Option>
            <Option value='Pacific/Truk'>Pacific/Truk</Option>
            <Option value='Pacific/Wake'>Pacific/Wake</Option>
            <Option value='Pacific/Wallis'>Pacific/Wallis</Option>
            <Option value='Pacific/Yap'>Pacific/Yap</Option>
            <Option value='Poland'>Poland</Option>
            <Option value='Portugal'>Portugal</Option>
            <Option value='ROC'>ROC</Option>
            <Option value='ROK'>ROK</Option>
            <Option value='Singapore'>Singapore</Option>
            <Option value='Turkey'>Turkey</Option>
            <Option value='UCT'>UCT</Option>
            <Option value='US/Alaska'>US/Alaska</Option>
            <Option value='US/Aleutian'>US/Aleutian</Option>
            <Option value='US/Arizona'>US/Arizona</Option>
            <Option value='US/Central'>US/Central</Option>
            <Option value='US/East-Indiana'>US/East-Indiana</Option>
            <Option value='US/Eastern'>US/Eastern</Option>
            <Option value='US/Hawaii'>US/Hawaii</Option>
            <Option value='US/Indiana-Starke'>US/Indiana-Starke</Option>
            <Option value='US/Michigan'>US/Michigan</Option>
            <Option value='US/Mountain'>US/Mountain</Option>
            <Option value='US/Pacific'>US/Pacific</Option>
            <Option value='US/Pacific-New'>US/Pacific-New</Option>
            <Option value='US/Samoa'>US/Samoa</Option>
            <Option value='UTC'>UTC</Option>
            <Option value='Universal'>Universal</Option>
            <Option value='W-SU'>W-SU</Option>
            <Option value='WET'>WET</Option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-config-input-timeformat"><i class="fa fa-clock-o"></i> Format:</label>
        <input type="text" id="node-config-input-timeformat" placeholder="Example: YYYY-MM-DD HH:mm:ss">
        <a href="https://momentjs.com/docs/#/parsing/string-format/" target="_blank" title="Get information about available formats..."><i class="fa fa-question-circle" aria-hidden="true"></i></a>
    </div>
    <div class="form-row">
        <label for="node-config-input-timeout" style="width:140px"><i class="fa fa-history"></i> Request-Timeout:</label>
        <input type="text" id="node-config-input-timeout" style="display:inline-block; width:80px; vertical-align:middle;" placeholder="5"><span>   Seconds</span>
    </div>
    <!-- Familiy Devices are not longer working-->
    <!--<hr>
    <div class="form-row">
        <label for="node-config-input-showfmly" style="width:155px"><i class="fa fa-users"></i> Show Family-Entries:</label>
        <input type="checkbox" checked id="node-config-input-showfmly" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-tips">
        <p><b>Info</b>: Family entries shows devices that you own in your family group as devices.</p>
    </div>-->
</script>



<!-- Node apple-find-me-sendmessage -->
<script type="text/javascript">
    RED.nodes.registerType('apple-find-me-sendmessage', {
        category: 'Mobile',
        color: '#66ff00',
        defaults: {
            account: {
                value: "",
                type: "apple-find-me-account",
                required: true
            },
            name: {
                value: ""
            },
            deviceid: {
                value: '',
                required: true,
                validate: RED.validators.typedInput('inputtype')
            },
            playsound: {
                value: true
            },
            subject: {
                value: 'Important Message'
            },
            text: {
                value: "",
                required: true,
                validate: RED.validators.typedInput('inputtype')
            },
            inputtype: {
                value: 'str'
            },
            inputtypetext: {
                value: 'str'
            },
        },
        inputs: 1,
        outputs: 1,
        icon: "apple.svg",
        paletteLabel: 'Send Message',
        label: function() {
            return this.name || "Apple Find me (Send Message)";
        },
        oneditprepare: function() {
            $('#node-input-deviceid').typedInput({
                default: 'str',
                typeField: $("#node-input-inputtype"),
                types: ['msg', 'str']
            });
            $('#node-input-text').typedInput({
                default: 'str',
                typeField: $("#node-input-inputtypetext"),
                types: ['msg', 'str']
            });
        },
        oneditsave: function() {},
        oneditresize: function() {}
    });
</script>

<script type="text/x-red" data-template-name="apple-find-me-sendmessage">
    <div class="form-row">
        <label for="node-input-account"><i class="fa fa-apple"></i> Account</label>
        <input type="text" id="node-input-account">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name:</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-deviceid"><i class="fa fa-sitemap"></i> Device-ID:</label>
        <input type="text" id="node-input-deviceid" style="width:70%">
        <input type="hidden" id="node-input-inputtype">
    </div>
    <div class="form-row">
        <label for="node-input-text"><i class="fa fa-commenting"></i> Message:</label>
        <input type="text" id="node-input-text">
        <input type="hidden" id="node-input-inputtypetext">
    </div>
    <div class="form-row">
        <label for="node-input-playsound" style="width:auto"><i class="fa fa-volume-up"></i> Play Sound:</label>
        <input type="checkbox" id="node-input-playsound" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
</script>

<script type="text/x-red" data-help-name="apple-find-me-sendmessage">
    <p>Sends a message to an iOS-Device</p>
</script>


<!-- Node apple-find-me-playsound -->
<script type="text/javascript">
    RED.nodes.registerType('apple-find-me-playsound', {
        category: 'Mobile',
        color: '#66ff00',
        defaults: {
            account: {
                value: "",
                type: "apple-find-me-account",
                required: true
            },
            name: {
                value: ""
            },
            deviceid: {
                value: '',
                required: true,
                validate: RED.validators.typedInput('inputtype')
            },
            subject: {
                value: 'Alarm Message'
            },
            inputtype: {
                value: 'str'
            }
        },
        inputs: 1,
        outputs: 1,
        icon: "apple.svg",
        paletteLabel: 'Find my Phone',
        label: function() {
            return this.name || "Apple Find me (Find my Phone)";
        },
        oneditprepare: function() {
            $('#node-input-deviceid').typedInput({
                default: 'str',
                typeField: $("#node-input-inputtype"),
                types: ['msg', 'str']
            });
        },
        oneditsave: function() {},
        oneditresize: function() {}
    });
</script>

<script type="text/x-red" data-template-name="apple-find-me-playsound">
    <div class="form-row">
        <label for="node-input-account"><i class="fa fa-apple"></i> Account</label>
        <input type="text" id="node-input-account">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name:</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-deviceid"><i class="fa fa-sitemap"></i> Device-ID:</label>
        <input type="text" id="node-input-deviceid" style="width:70%">
        <input type="hidden" id="node-input-inputtype">
    </div>
</script>

<script type="text/x-red" data-help-name="apple-find-me-playsound">
    <p>Run Find my iPhone</p>
</script>



<!-- Node apple-find-me -->
<script type="text/javascript">
    RED.nodes.registerType('apple-find-me', {
        category: 'Mobile',
        color: '#66ff00',
        defaults: {
            account: {
                value: "",
                type: "apple-find-me-account",
                required: true
            },
            name: {
                value: ""
            },
            triggerInterval: {
                value: "300000"
            },
            geoAPI: {
                value: "OSM"
            },
            distanceInMeter: {
                value: 150,
                validate: RED.validators.number()
            },
            hereMapApiKey: {
                value: ""
            },
            googleMapsApiKey: {
                value: ""
            },
            places: {
                value: [{
                    name: '',
                    lat: '',
                    lon: ''
                }],
                validate: function(v) {
                    var unique = new Set(v.map(function(o) {
                        return o.name;
                    }));
                    return v.length == unique.size;
                }
            },
        },
        inputs: 0,
        outputs: 1,
        paletteLabel: 'Locate my Devices',
        icon: "apple.svg",
        label: function() {
            return this.name || "Apple Find me";
        },
        oneditprepare: function() {
            var un = new Set(this.places.map(function(o) {
                return o.name
            }));
            if (this.places.length == un.size) {
                $("#valWarning").hide();
            } else {
                $("#valWarning").show();
            }

            if (this.geoAPI == "HERE") {
                $("#HereMapAPIKey").show();
                $("#HereTips").show();
                $("#GoogleTips").hide();
                $("#GoogleMapsAPIKey").hide();

            } else if (this.geoAPI == "GOOGLE") {
                $("#HereMapAPIKey").hide();
                $("#HereTips").hide();
                $("#GoogleTips").show();
                $("#GoogleMapsAPIKey").show();
            } else {
                $("#HereMapAPIKey").hide();
                $("#GoogleMapsAPIKey").hide();
                $("#HereTips").hide();
                $("#GoogleTips").hide();
            }

            $('#node-input-geoAPI').change(function() {
                if (this.value == "HERE") {
                    $("#HereMapAPIKey").show();
                    $("#HereTips").show();
                    $("#GoogleTips").hide();
                    $("#GoogleMapsAPIKey").hide();

                } else if (this.value == "GOOGLE") {
                    $("#HereMapAPIKey").hide();
                    $("#HereTips").hide();
                    $("#GoogleTips").show();
                    $("#GoogleMapsAPIKey").show();
                } else {
                    $("#HereMapAPIKey").hide();
                    $("#GoogleMapsAPIKey").hide();
                    $("#HereTips").hide();
                    $("#GoogleTips").hide();
                }

            });

            function generatePlace(i, place) {
                var container = $('<li/>', {
                    style: "margin:0; padding:8px 0px 0px; border-bottom: 1px solid #ccc;"
                });
                var row = $('<div/>').appendTo(container);
                var row2 = $('<div/>', {
                    style: "padding-top:5px; padding-left:175px;"
                }).appendTo(container);
                var row3 = $('<div/>', {
                    style: "padding-top:5px; padding-left:120px;"
                }).appendTo(container);

                $('<i style="color:#eee; cursor:move; margin-left:3px;" class="node-input-place-handle fa fa-bars"></i>').appendTo(row);

                var nameField = $('<input/>', {
                    class: "node-input-place-name",
                    type: "text",
                    style: "margin-left:7px; width:calc(30% - 32px);",
                    placeholder: 'Name',
                    value: place.name
                }).appendTo(row);
                var latField = $('<input/>', {
                    class: "node-input-place-lat",
                    type: "text",
                    style: "margin-left:7px; width:calc(35% - 25px);",
                    placeholder: 'Latitude',
                    value: place.lat
                }).appendTo(row);
                var lonField = $('<input/>', {
                    class: "node-input-place-lon",
                    type: "text",
                    style: "margin-left:7px; width:calc(35% - 25px);",
                    placeholder: 'Longitude',
                    value: place.lon
                }).appendTo(row);

                var finalspan = $('<span/>', {
                    style: "float:right; margin-right:8px;"
                }).appendTo(row);
                var deleteButton = $('<a/>', {
                    href: "#",
                    class: "editor-button editor-button-small",
                    style: "margin-top:7px; margin-left:5px;"
                }).appendTo(finalspan);
                $('<i/>', {
                    class: "fa fa-remove"
                }).appendTo(deleteButton);

                deleteButton.click(function() {
                    container.css({
                        "background": "#fee"
                    });
                    container.fadeOut(300, function() {
                        $(this).remove();
                    });
                });

                $("#node-input-places-container").append(container);
            }

            $("#node-input-add-places").click(function() {
                generatePlace($("#node-input-places-container").children().length + 1, {});
                $("#node-input-places-container-div").scrollTop($("#node-input-places-container-div").get(0).scrollHeight);
            });

            for (var i = 0; i < this.places.length; i++) {
                var place = this.places[i];
                if (place.name != "") {
                    generatePlace(i + 1, place);
                }
            }

            $("#node-input-places-container").sortable({
                axis: "y",
                handle: ".node-input-place-handle",
                cursor: "move"
            });
        },
        oneditsave: function() {
            var places = $("#node-input-places-container").children();
            var node = this;
            node.places = [];
            places.each(function(i) {
                var place = $(this);
                var o = {
                    name: place.find(".node-input-place-name").val(),
                    lat: place.find(".node-input-place-lat").val(),
                    lon: place.find(".node-input-place-lon").val()
                };

                node.places.push(o);
            });
        },
        oneditresize: function() {}
    });
</script>

<script type="text/x-red" data-template-name="apple-find-me">
    <div class="form-row">
        <label for="node-input-account"><i class="icon-tag"></i> Account</label>
        <input type="text" id="node-input-account">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-geoAPI" style=""><i class="fa fa-map-signs"></i> Geo-API:</label>
        <select id="node-input-geoAPI" style="width:70%;">
            <option value="OSM">OpenStreetMap</option>
            <option value="HERE">HereMaps</option>
            <option value="GOOGLE">GoogleMaps</option>
        </select>
    </div>
    <div class="form-row" id="HereMapAPIKey">
        <label for="node-input-hereMapApiKey" style="text-align:right;"><i class="fa fa-key"></i> API-Key:</label>
        <input type="password" id="node-input-hereMapApiKey" placeholder="HereMaps API-Key">
    </div>

    <div class="form-row" id="GoogleMapsAPIKey">
        <label for="node-input-googleMapsApiKey" style="text-align:right;"><i class="fa fa-key"></i> API-Key:</label>
        <input type="password" id="node-input-googleMapsApiKey" placeholder="GoogleMaps API-Key">
    </div>

    <div class="form-row">
        <label for="node-input-triggerInterval" style="width:auto"><i class="fa fa-clock-o"></i> Trigger Interval:</label>
        <select id="node-input-triggerInterval" style="width:70%;">
            <option value="60000">1 Minutes</option>
            <option value="300000">5 Minutes</option>
            <option value="600000">10 Minutes</option>
            <option value="900000">15 Minutes</option>
            <option value="1800000">30 Minutes</option>
            <option value="3600000">60 Minutes</option>
        </select>
    </div>
    <div class="form-row node-input-places-container-row" style="margin-bottom: 0px;width: 100%">
        <label for="node-input-width" style="vertical-align:top"><i class="fa fa-map-marker"></i> Places</label>
        <div id="node-input-places-container-div" style="box-sizing:border-box; border-radius:5px; height:257px; padding:5px; border:1px solid #ccc; overflow-y:scroll; display:inline-block; width:calc(70% + 15px);">
            <span id="valWarning" style="color:#910000"><b>All Values must be unique.</b></span>
            <ol id="node-input-places-container" style="list-style-type:none; margin:0;"></ol>
        </div>
    </div>
    <div class="form-row">
        <a href="#" class="editor-button editor-button-small" id="node-input-add-places" style="margin-top:4px; margin-left:103px;"><i class="fa fa-plus"></i> <span>Add Place</span></a>
    </div>
    <div class="form-row">
        <label for="node-input-distanceInMeter"><i class="fa fa-arrows"></i> Distance (Meters):</label>
        <input type="text" id="node-input-distanceInMeter">
    </div>
    <br/>
    <div class="form-tips" id="HereTips">
        <p>You don't have an API KEY for HereMaps? Then you can create one here: <a href="https://developer.here.com/" target="_new">Click</a></p>
    </div>
    <div class="form-tips" id="GoogleTips">
        <p>You don't have an API KEY for GoogleMaps? Then you can create one here: <a href="https://developers.google.com/maps/documentation/javascript/get-api-key" target="_new">Click</a></p>
    </div>
</script>

<script type="text/x-red" data-help-name="apple-find-me">
    <p>Finds all iOS devices in your Apple account and calls up the parameters based on the set interval.</p>
</script>

<!-- Node apple-find-me-with-payload -->
<script type="text/javascript">
    RED.nodes.registerType('apple-find-me-with-payload', {
        category: 'Mobile',
        color: '#66ff00',
        defaults: {
            account: {
                value: "",
                type: "apple-find-me-account",
                required: true
            },
            name: {
                value: ""
            },
            geoAPI: {
                value: "OSM"
            },
            distanceInMeter: {
                value: 150,
                validate: RED.validators.number()
            },
            hereMapApiKey: {
                value: ""
            },
            googleMapsApiKey: {
                value: ""
            },
            places: {
                value: [{
                    name: '',
                    lat: '',
                    lon: ''
                }],
                validate: function(v) {
                    var unique = new Set(v.map(function(o) {
                        return o.name;
                    }));
                    return v.length == unique.size;
                }
            },
        },
        inputs: 1,
        outputs: 1,
        paletteLabel: 'Locate my Devices (Input)',
        icon: "apple.svg",
        label: function() {
            return this.name || "Apple Find me";
        },
        oneditprepare: function() {
            var un = new Set(this.places.map(function(o) {
                return o.name
            }));
            if (this.places.length == un.size) {
                $("#valWarning").hide();
            } else {
                $("#valWarning").show();
            }

            if (this.geoAPI == "HERE") {
                $("#HereMapAPIKey").show();
                $("#HereTips").show();
                $("#GoogleTips").hide();
                $("#GoogleMapsAPIKey").hide();

            } else if (this.geoAPI == "GOOGLE") {
                $("#HereMapAPIKey").hide();
                $("#HereTips").hide();
                $("#GoogleTips").show();
                $("#GoogleMapsAPIKey").show();
            } else {
                $("#HereMapAPIKey").hide();
                $("#GoogleMapsAPIKey").hide();
                $("#HereTips").hide();
                $("#GoogleTips").hide();
            }

            $('#node-input-geoAPI').change(function() {
                if (this.value == "HERE") {
                    $("#HereMapAPIKey").show();
                    $("#HereTips").show();
                    $("#GoogleTips").hide();
                    $("#GoogleMapsAPIKey").hide();

                } else if (this.value == "GOOGLE") {
                    $("#HereMapAPIKey").hide();
                    $("#HereTips").hide();
                    $("#GoogleTips").show();
                    $("#GoogleMapsAPIKey").show();
                } else {
                    $("#HereMapAPIKey").hide();
                    $("#GoogleMapsAPIKey").hide();
                    $("#HereTips").hide();
                    $("#GoogleTips").hide();
                }

            });

            function generatePlace(i, place) {
                var container = $('<li/>', {
                    style: "margin:0; padding:8px 0px 0px; border-bottom: 1px solid #ccc;"
                });
                var row = $('<div/>').appendTo(container);
                var row2 = $('<div/>', {
                    style: "padding-top:5px; padding-left:175px;"
                }).appendTo(container);
                var row3 = $('<div/>', {
                    style: "padding-top:5px; padding-left:120px;"
                }).appendTo(container);

                $('<i style="color:#eee; cursor:move; margin-left:3px;" class="node-input-place-handle fa fa-bars"></i>').appendTo(row);

                var nameField = $('<input/>', {
                    class: "node-input-place-name",
                    type: "text",
                    style: "margin-left:7px; width:calc(30% - 32px);",
                    placeholder: 'Name',
                    value: place.name
                }).appendTo(row);
                var latField = $('<input/>', {
                    class: "node-input-place-lat",
                    type: "text",
                    style: "margin-left:7px; width:calc(35% - 25px);",
                    placeholder: 'Latitude',
                    value: place.lat
                }).appendTo(row);
                var lonField = $('<input/>', {
                    class: "node-input-place-lon",
                    type: "text",
                    style: "margin-left:7px; width:calc(35% - 25px);",
                    placeholder: 'Longitude',
                    value: place.lon
                }).appendTo(row);

                var finalspan = $('<span/>', {
                    style: "float:right; margin-right:8px;"
                }).appendTo(row);
                var deleteButton = $('<a/>', {
                    href: "#",
                    class: "editor-button editor-button-small",
                    style: "margin-top:7px; margin-left:5px;"
                }).appendTo(finalspan);
                $('<i/>', {
                    class: "fa fa-remove"
                }).appendTo(deleteButton);

                deleteButton.click(function() {
                    container.css({
                        "background": "#fee"
                    });
                    container.fadeOut(300, function() {
                        $(this).remove();
                    });
                });

                $("#node-input-places-container").append(container);
            }

            $("#node-input-add-places").click(function() {
                generatePlace($("#node-input-places-container").children().length + 1, {});
                $("#node-input-places-container-div").scrollTop($("#node-input-places-container-div").get(0).scrollHeight);
            });

            for (var i = 0; i < this.places.length; i++) {
                var place = this.places[i];
                if (place.name != "") {
                    generatePlace(i + 1, place);
                }
            }

            $("#node-input-places-container").sortable({
                axis: "y",
                handle: ".node-input-place-handle",
                cursor: "move"
            });
        },
        oneditsave: function() {
            var places = $("#node-input-places-container").children();
            var node = this;
            node.places = [];
            places.each(function(i) {
                var place = $(this);
                var o = {
                    name: place.find(".node-input-place-name").val(),
                    lat: place.find(".node-input-place-lat").val(),
                    lon: place.find(".node-input-place-lon").val()
                };

                node.places.push(o);
            });
        },
        oneditresize: function() {}
    });
</script>

<script type="text/x-red" data-template-name="apple-find-me-with-payload">
    <div class="form-row">
        <label for="node-input-account"><i class="icon-tag"></i> Account</label>
        <input type="text" id="node-input-account">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-geoAPI" style=""><i class="fa fa-map-signs"></i> Geo-API:</label>
        <select id="node-input-geoAPI" style="width:70%;">
            <option value="OSM">OpenStreetMap</option>
            <option value="HERE">HereMaps</option>
            <option value="GOOGLE">GoogleMaps</option>
        </select>
    </div>
    <div class="form-row" id="HereMapAPIKey">
        <label for="node-input-hereMapApiKey" style="text-align:right;"><i class="fa fa-key"></i> API-Key:</label>
        <input type="password" id="node-input-hereMapApiKey" placeholder="HereMaps API-Key">
    </div>

    <div class="form-row" id="GoogleMapsAPIKey">
        <label for="node-input-googleMapsApiKey" style="text-align:right;"><i class="fa fa-key"></i> API-Key:</label>
        <input type="password" id="node-input-googleMapsApiKey" placeholder="GoogleMaps API-Key">
    </div>

    <div class="form-row node-input-places-container-row" style="margin-bottom: 0px;width: 100%">
        <label for="node-input-width" style="vertical-align:top"><i class="fa fa-map-marker"></i> Places</label>
        <div id="node-input-places-container-div" style="box-sizing:border-box; border-radius:5px; height:257px; padding:5px; border:1px solid #ccc; overflow-y:scroll; display:inline-block; width:calc(70% + 15px);">
            <span id="valWarning" style="color:#910000"><b>All Values must be unique.</b></span>
            <ol id="node-input-places-container" style="list-style-type:none; margin:0;"></ol>
        </div>
    </div>
    <div class="form-row">
        <a href="#" class="editor-button editor-button-small" id="node-input-add-places" style="margin-top:4px; margin-left:103px;"><i class="fa fa-plus"></i> <span>Add Place</span></a>
    </div>
    <div class="form-row">
        <label for="node-input-distanceInMeter"><i class="fa fa-arrows"></i> Distance (Meters):</label>
        <input type="text" id="node-input-distanceInMeter">
    </div>
    <br/>
    <div class="form-tips" id="HereTips">
        <p>You don't have an API KEY for HereMaps? Then you can create one here: <a href="https://developer.here.com/" target="_new">Click</a></p>
    </div>
    <div class="form-tips" id="GoogleTips">
        <p>You don't have an API KEY for GoogleMaps? Then you can create one here: <a href="https://developers.google.com/maps/documentation/javascript/get-api-key" target="_new">Click</a></p>
    </div>
</script>

<script type="text/x-red" data-help-name="apple-find-me-with-payload">
    <p>Finds all iOS devices in your Apple account and only calls up the parameters if there is an input.</p>
</script>